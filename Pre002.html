<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏Ç‡∏≤</title>

  <script type="module"
    src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
  </script>

  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      background: #fafafa;
    }
    #infoBox {
      margin-top: 20px;
      padding: 15px;
      width: 350px;
      background: white;
      box-shadow: 0px 2px 10px rgba(0,0,0,0.15);
      border-radius: 10px;
      display: inline-block;
      text-align: left;
    }
  </style>
</head>

<body>

  <h2>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏Ç‡∏≤</h2>

  <model-viewer id="viewer"
    src="https://modelagency.pw/ggaa_ZZ.glb"
    camera-controls
    touch-action="none"
    exposure="1"
    ar
    disable-zoom
    style="width: 800px; height: 500px; background:#ddd; border-radius:15px;"

    experimental-features="hit-test"
    >

  </model-viewer>

  <div id="infoBox">
    <b>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</b>
    <pre id="output">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•</pre>
  </div>

  <script>
    const viewer = document.getElementById("viewer");
    const output = document.getElementById("output");

    viewer.addEventListener("load", () => {
      console.log("MODEL LOADED");
    });

    viewer.addEventListener("click", async (event) => {
      console.log("CLICK DETECTED");

      const rect = viewer.getBoundingClientRect();
      const clickX = event.clientX - rect.left;
      const clickY = event.clientY - rect.top;

      const normalizedX = clickX / rect.width;
      const normalizedY = clickY / rect.height;

      // üéØ hitTest ‡∏Ç‡∏≠‡∏á model-viewer
      const hits = await viewer.scene.hitTest(normalizedX, normalizedY);

      if (!hits || hits.length === 0) {
        console.log("HIT RESULT: null");

        output.innerText = JSON.stringify(
          { Error: "‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏°‡πà‡∏°‡∏µ mesh" },
          null,
          2
        );
        return;
      }

      const hit = hits[0];

      console.log("HIT RESULT:", hit);

      output.innerText = JSON.stringify({
        point: hit.point,
        normal: hit.normal,
        face: hit.face
      }, null, 2);
    });
  </script>

</body>
</html>
