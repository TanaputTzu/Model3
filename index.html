<script>
  const viewer = document.querySelector("#viewer");
  const select = document.querySelector("#animationSelect");

  viewer.addEventListener("load", () => {
    const animations = viewer.availableAnimations;
    console.log("พบอนิเมชัน:", animations);

    animations.forEach(name => {
      const option = document.createElement("option");
      option.value = name;
      option.textContent = name;
      select.appendChild(option);
    });

    let index = 0;

    function playNext() {
      const name = animations[index];
      select.value = name;
      viewer.play({ animationName: name, repetitions: 1 });
      console.log("กำลังเล่น:", name);

      // เมื่อเล่นจบ ให้ไปอนิเมชันถัดไป
      viewer.addEventListener("finished", () => {
        index = (index + 1) % animations.length;
        playNext();
      }, { once: true });
    }

    if (animations.length > 0) playNext();
  });

  function playSelected() {
    const chosen = select.value;
    if (chosen) {
      viewer.play({ animationName: chosen, repetitions: Infinity });
    }
  }
</script>
